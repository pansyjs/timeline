"use strict";(self.webpackChunk_pansy_react_timeline=self.webpackChunk_pansy_react_timeline||[]).push([["623"],{9231:function(e,t,a){a.r(t),a.d(t,{default:()=>S});var l=a(2676),r=a(5271),n=a(4461),i=a(4875),o=a.n(i),s=a(6483),d=a.n(s);let m="pansy",u=[{scale:"minute",step:1,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:5,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:10,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:30,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"hour",step:1,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"hour",step:6,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"hour",step:12,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"day",step:1,labelStep:1,majorLabelFormat:"YYYY-MM",minorLabelFormat:"DD"}],c={paddingStart:48,paddingEnd:48,width:1},f="YYYY-MM-DD HH:mm:ss",p="#2B6DE5";function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return e?`${t}-${e}`:t}let h=r.createContext({prefixCls:m,defaultColor:p,getPrefixCls:v});a(5411);let b=r.forwardRef((e,t)=>{let{className:a,style:i,hover:o,data:s,checked:m,position:u=24,...c}=e,{getPrefixCls:p,defaultColor:v}=r.useContext(h),b=p("timeline-card"),{color:g=v,time:x}=s,y=(!x?[]:Array.isArray(x)?x:[x]).reduce((e,t)=>{let a=d()(t).format(f);return e?e+" ~ "+a:e+a},"");return(0,l.jsxs)("div",{className:(0,n.W)(b,a),style:{...i,top:u},ref:t,...c,children:[(0,l.jsx)("div",{className:`${b}-line`,style:{backgroundColor:o||m?g:void 0,top:-u,height:u}}),(0,l.jsxs)("div",{className:`${b}-cntent`,style:{borderColor:g},children:[(0,l.jsx)("div",{className:`${b}-title`,children:null==s?void 0:s.title}),(0,l.jsx)("div",{className:`${b}-time`,children:y})]})]})});b.displayName="TimeCard";var g=a(9108);let x=(0,a(7977).Z)();function y(e){let{timeRange:t,children:a}=e,[i,o]=r.useState(0),{getPrefixCls:s,rootElement:m}=r.useContext(h),f=s("timeline-axis"),p=r.useCallback(()=>{let e=[];if(!t)return e;let{step:a,scale:l}=u[i];for(let r=t.start;r.isBefore(t.end);r=r.add(a,l))e.push({time:r});return e},[t])(),v=(0,g.MG)({horizontal:!0,count:p.length,getScrollElement:()=>m,estimateSize:()=>1,gap:8,paddingStart:c.paddingStart,paddingEnd:c.paddingEnd}),b=e=>{v.scrollToOffset(v.scrollOffset+e.dx)};return r.useEffect(()=>(x.on("panmove",b),()=>{x.off("panmove",b)}),[]),(0,l.jsxs)("div",{className:f,style:{width:`${v.getTotalSize()}px`},children:[v.getVirtualItems().map(e=>{let{index:t,key:a}=e,{time:r}=p[t],{labelStep:o,majorLabelFormat:s,minorLabelFormat:m}=u[i],c=d()(r).format(s),h=d()(r).format(m),b=t%o==0;return(0,l.jsx)("div",{className:(0,n.W)(`${f}-tick`,{[`${f}-tick-major`]:b,[`${f}-tick-big-major`]:0===t}),"data-index":t,ref:v.measureElement,style:{transform:`translateX(${e.start}px)`},children:b&&(0,l.jsx)("div",{className:`${f}-tick-lable`,children:0===t?c:h})},a)}),a]})}a(7045);let Y=(0,a(4706).H)(function(e){let{color:t,opacity:a=.3}=e;if(!t)return;if("number"!=typeof a||a<0||a>1)throw Error("透明度必须是0到1之间的数字");let l=document.createElement("div");l.style.display="none",l.style.color=t,document.body.appendChild(l);let r=getComputedStyle(l).color;document.body.removeChild(l);let n=r.match(/^rgb(a)?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);if(n){let[,,e,t,l]=n;return`rgba(${e}, ${t}, ${l}, ${a})`}},{getCacheKey:e=>e.color+e.opacity});function j(e){let{className:t,style:a,data:i,checked:o,hover:s,...m}=e,{getPrefixCls:u,defaultColor:c}=r.useContext(h),p=u("timeline-point"),{time:v,color:b=c}=i;return Array.isArray(v)&&2===v.length?(0,l.jsxs)("div",{className:(0,n.W)(p,`${p}-range`,t),style:{...a,backgroundColor:s||o?Y({color:b}):void 0},...m,children:[(0,l.jsx)("div",{className:`${p}-dot`,title:d()(v[0]).format(f),style:{backgroundColor:s||o?b:void 0}}),(0,l.jsx)("div",{className:`${p}-dot`,title:d()(v[1]).format(f),style:{backgroundColor:s||o?b:void 0}})]}):(0,l.jsx)("div",{className:(0,n.W)(p,`${p}-dot`,t),style:{...a,backgroundColor:s||o?b:void 0},title:d()(v).format(f)})}a(8955);let M=e=>Array.isArray(e)&&2===e.length;function C(e){let{start:t,end:a}=e,l=0===d()(a).minute()&&0===d()(a).second()&&0===d()(a).millisecond();return{start:d()(t).startOf("hour"),end:l?d()(a):d()(a).add(1,"hour").startOf("hour")}}function k(e){let{className:t,style:a,data:i=[],moveable:s=!0,defaultColor:u=p,onSelect:f}=e,g=e.prefixCls||m,Y=r.useRef(null),[k,$]=r.useState(!1),[S,D]=r.useState(null),[L,E]=r.useState(null),[F,H]=r.useState(),w=r.useCallback(e=>v(e,g),[g]),N=w("timeline");function A(e){e.preventDefault()}r.useEffect(()=>{let e=Y.current;if(!e)return;o()(e).styleCursor(!1).draggable({lockAxis:"x",inertia:!0,listeners:{start(e){s&&x.emit("panstart",e)},move(e){s&&x.emit("panmove",e)},end(e){s&&x.emit("panend",e)}}}).on("mousedown",function(){$(!0)}).on("mouseup",function(){$(!1)});let t="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";return e.addEventListener(t,A,!1),()=>{o()(e).unset(),e.removeEventListener(t,A,!1)}},[]),r.useEffect(()=>{H(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{padding:a=30,minRange:l=1440,defaultCenter:r=d()()}=t,n=d()(r),i={start:n.subtract(l/2,"minute"),end:n.add(l/2,"minute")};if(!e||0===e.length)return C(i);let o=e.flatMap(e=>M(e.time)?[d()(e.time[0]),d()(e.time[1])]:[d()(e.time)]);if(1===o.length){let e=d()(o[0]);return C({start:e.subtract(l/2,"minute"),end:e.add(l/2,"minute")})}let s=d()(Math.min(...o.map(e=>e.valueOf()))),m=d()(Math.max(...o.map(e=>e.valueOf()))),u=s.subtract(a,"minute"),c=m.add(a,"minute"),f=c.diff(u,"minute");if(f<l){let e=(l-f)/2;return C({start:u.subtract(e,"minute"),end:c.add(e,"minute")})}return C({start:u,end:c})}(i,{padding:30,minRange:1440,defaultCenter:new Date}))},[i]);let O=e=>{D(e)},W=e=>{if((null==L?void 0:L.id)===e.id){E(null),null==f||f(null);return}E(e),null==f||f(e)};return(0,l.jsx)("div",{className:(0,n.W)(N,t),ref:Y,style:{cursor:k?"grabbing":"grab",...a},children:(0,l.jsxs)(h.Provider,{value:{prefixCls:N,getPrefixCls:w,defaultColor:u,rootElement:Y.current},children:[(0,l.jsx)(y,{timeRange:F}),(0,l.jsx)("div",{className:`${N}-cointent`,children:F&&i.map((e,t)=>{let a,{time:n,id:i}=e,o=function(e){let{targetTime:t,baseTime:a,tickIntervalMs:l,tickWidth:r,tickGap:n,paddingStart:i,potSize:o}=e,s=d()(t).valueOf();return(s-d()(a).valueOf())/l*(r+n)+i-o/2}({targetTime:Array.isArray(n)?n[0]:n,baseTime:F.start,tickIntervalMs:6e4,tickWidth:c.width,tickGap:8,paddingStart:c.paddingStart,potSize:8});return Array.isArray(n)&&2===n.length&&(a=function(e){let{timeRange:t,tickIntervalMs:a,tickWidth:l,tickGap:r}=e,n=d()(t.start).valueOf();return(d()(t.end).valueOf()-n)/a*(l+r)+r}({timeRange:{start:n[0],end:n[1]},tickIntervalMs:6e4,tickWidth:c.width,tickGap:8})),(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)(j,{style:{transform:`translateX(${o}px)`,width:a?`${a}px`:void 0},data:e,hover:e.id===(null==S?void 0:S.id),checked:e.id===(null==L?void 0:L.id),onMouseEnter:()=>{O(e)},onMouseLeave:()=>{O(null)},onClick:()=>{W(e)}}),(0,l.jsx)(b,{style:{transform:`translateX(${o+4}px)`},position:t%2?24:100,ref:e=>{console.log(e)},hover:e.id===(null==S?void 0:S.id),checked:e.id===(null==L?void 0:L.id),data:e,onMouseEnter:()=>{O(e)},onMouseLeave:()=>{O(null)},onClick:()=>{W(e)}})]},i||t)})})]})})}a(5924);let $=[{id:"1",title:"单点事件",color:"#A140E7",time:"2024-03-10 10:00:00"},{id:"1111",title:"单点事件",time:"2024-03-10 10:01:00"},{id:"2",title:"时间范围事件",color:"#A140E7",time:["2024-03-10 11:30:00","2024-03-10 13:30:00"]},{id:"3",title:"单点事件",time:"2024-03-10 16:00:00"},{id:"4",title:"长时间范围事件",time:["2024-03-10 14:15:00","2024-03-10 18:15:00"]},{id:"5",title:"长时间范围事件",time:["2024-03-10 19:15:00","2024-03-10 23:15:00"]}],S=function(){return(0,l.jsx)(k,{data:$})}}}]);