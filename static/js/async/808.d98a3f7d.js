"use strict";(self.webpackChunk_pansy_react_timeline=self.webpackChunk_pansy_react_timeline||[]).push([["808"],{3890:function(e,t,r){r.r(t),r.d(t,{default:()=>L});var l=r(2676),n=r(5271),a=r(4461),i=r(1031),o=r(4875),s=r.n(o),d=r(6483),u=r.n(d);let m="pansy",c=[{scale:"minute",step:1,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:5,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:10,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"minute",step:30,labelStep:10,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm:ss"},{scale:"hour",step:1,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"hour",step:6,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"hour",step:12,labelStep:5,majorLabelFormat:"YYYY-MM-DD",minorLabelFormat:"HH:mm"},{scale:"day",step:1,labelStep:1,majorLabelFormat:"YYYY-MM",minorLabelFormat:"DD"}],f={paddingStart:48,paddingEnd:48,width:1},v="YYYY-MM-DD HH:mm:ss",h="#2B6DE5";function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return e?`${t}-${e}`:t}let b=n.createContext({prefixCls:m,defaultColor:h,getPrefixCls:p});r(5411);let g=n.forwardRef(function(e,t){let{className:r,style:i,hover:o,data:s,checked:d,position:m=24,render:c,...f}=e,{getPrefixCls:h,defaultColor:p}=n.useContext(b),g=h("timeline-card"),{color:x=p,customRender:y=!0,time:Y}=s,M=(!Y?[]:Array.isArray(Y)?Y:[Y]).reduce((e,t)=>{let r=u()(t).format(v);return e?e+" ~ "+r:e+r},""),j=n.useMemo(()=>y&&c?c({...s,color:x}):(0,l.jsxs)("div",{className:`${g}-cntent`,style:{borderColor:x},children:[(0,l.jsx)("div",{className:`${g}-title`,children:null==s?void 0:s.title}),(0,l.jsx)("div",{className:`${g}-time`,children:M})]}),[s,x,y,c]);return(0,l.jsxs)("div",{className:(0,a.W)(g,r),style:{...i,top:m,zIndex:d?50:void 0},ref:t,...f,children:[(0,l.jsx)("div",{className:`${g}-line`,style:{backgroundColor:o||d?x:void 0,top:-m,height:m}}),j]})});g.displayName="TimeCard";var x=r(9108);let y=(0,r(7977).Z)();function Y(e){let{timeRange:t,children:r}=e,[i,o]=n.useState(0),{getPrefixCls:s,rootElement:d}=n.useContext(b),m=s("timeline-axis"),v=n.useCallback(()=>{let e=[];if(!t)return e;let{step:r,scale:l}=c[i];for(let n=t.start;n.isBefore(t.end);n=n.add(r,l))e.push({time:n});return e},[t])(),h=(0,x.MG)({horizontal:!0,count:v.length,getScrollElement:()=>d,estimateSize:()=>1,gap:8,paddingStart:f.paddingStart,paddingEnd:f.paddingEnd}),p=e=>{h.scrollToOffset(h.scrollOffset+e.dx)};return n.useEffect(()=>(y.on("panmove",p),()=>{y.off("panmove",p)}),[]),(0,l.jsxs)("div",{className:m,style:{width:`${h.getTotalSize()}px`},children:[h.getVirtualItems().map(e=>{let{index:t,key:r}=e,{time:n}=v[t],{labelStep:o,majorLabelFormat:s,minorLabelFormat:d}=c[i],f=u()(n).format(s),p=u()(n).format(d),b=t%o==0;return(0,l.jsx)("div",{className:(0,a.W)(`${m}-tick`,{[`${m}-tick-major`]:b,[`${m}-tick-big-major`]:0===t}),"data-index":t,ref:h.measureElement,style:{transform:`translateX(${e.start}px)`},children:b&&(0,l.jsx)("div",{className:`${m}-tick-lable`,children:0===t?f:p})},r)}),r]})}r(7045);let M=(0,r(4706).H)(function(e){let{color:t,opacity:r=.3}=e;if(!t)return;if("number"!=typeof r||r<0||r>1)throw Error("透明度必须是0到1之间的数字");let l=document.createElement("div");l.style.display="none",l.style.color=t,document.body.appendChild(l);let n=getComputedStyle(l).color;document.body.removeChild(l);let a=n.match(/^rgb(a)?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);if(a){let[,,e,t,l]=a;return`rgba(${e}, ${t}, ${l}, ${r})`}},{getCacheKey:e=>e.color+e.opacity});function j(e){let{className:t,style:r,data:i,checked:o,hover:s,...d}=e,{getPrefixCls:m,defaultColor:c}=n.useContext(b),f=m("timeline-point"),{time:h,color:p=c}=i;return Array.isArray(h)&&2===h.length?(0,l.jsxs)("div",{className:(0,a.W)(f,`${f}-range`,t),style:{...r,backgroundColor:s||o?M({color:p}):void 0},...d,children:[(0,l.jsx)("div",{className:`${f}-dot`,title:u()(h[0]).format(v),style:{backgroundColor:s||o?p:void 0}}),(0,l.jsx)("div",{className:`${f}-dot`,title:u()(h[1]).format(v),style:{backgroundColor:s||o?p:void 0}})]}):(0,l.jsx)("div",{className:(0,a.W)(f,`${f}-dot`,t),style:{...r,backgroundColor:s||o?p:void 0},title:u()(h).format(v)})}r(8955);let k=e=>Array.isArray(e)&&2===e.length;function C(e){let{start:t,end:r}=e,l=0===u()(r).minute()&&0===u()(r).second()&&0===u()(r).millisecond();return{start:u()(t).startOf("hour"),end:l?u()(r):u()(r).add(1,"hour").startOf("hour")}}let S=e=>{let{offsetWidth:t,offsetHeight:r}=e;return{width:t,height:r}},w=(e,t)=>{let r=e=>{let{width:t,height:r}=e;return{width:Math.round(t),height:Math.round(r)}};if(null==t?void 0:t.borderBoxSize){let e=t.borderBoxSize[0];if(e)return r({width:e.inlineSize,height:e.blockSize})}return r(S(e))};function $(e){let{className:t,style:r,data:o=[],moveable:d=!0,defaultColor:c=h,renderCard:v,onSelect:x}=e,M=e.prefixCls||m,[S]=n.useState(()=>new Map),[$]=n.useState(()=>new Map),D=n.useRef(null),[L,E]=n.useState(!1),[F,H]=n.useState(null),[A,N]=n.useState(null),[O,R]=n.useState(),z=n.useCallback(e=>p(e,M),[M]),W=z("timeline");function _(e){e.preventDefault()}n.useEffect(()=>{let e=D.current;if(!e)return;s()(e).styleCursor(!1).draggable({lockAxis:"x",inertia:!0,listeners:{start(e){d&&y.emit("panstart",e)},move(e){d&&y.emit("panmove",e)},end(e){d&&y.emit("panend",e)}}}).on("mousedown",function(){E(!0)}).on("mouseup",function(){E(!1)});let t="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";return e.addEventListener(t,_,!1),()=>{s()(e).unset(),e.removeEventListener(t,_,!1)}},[]),n.useEffect(()=>{R(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{padding:r=30,minRange:l=1440,defaultCenter:n=u()()}=t,a=u()(n),i={start:a.subtract(l/2,"minute"),end:a.add(l/2,"minute")};if(!e||0===e.length)return C(i);let o=e.flatMap(e=>k(e.time)?[u()(e.time[0]),u()(e.time[1])]:[u()(e.time)]);if(1===o.length){let e=u()(o[0]);return C({start:e.subtract(l/2,"minute"),end:e.add(l/2,"minute")})}let s=u()(Math.min(...o.map(e=>e.valueOf()))),d=u()(Math.max(...o.map(e=>e.valueOf()))),m=s.subtract(r,"minute"),c=d.add(r,"minute"),f=c.diff(m,"minute");if(f<l){let e=(l-f)/2;return C({start:m.subtract(e,"minute"),end:c.add(e,"minute")})}return C({start:m,end:c})}(o,{padding:30,minRange:1440,defaultCenter:new Date}))},[o]);let I=e=>{H(e)},T=e=>{if((null==A?void 0:A.id)===e.id){N(null),null==x||x(null);return}N(e),null==x||x(e)},B=(()=>{let e=null,t=()=>e||(window.ResizeObserver?e=new window.ResizeObserver(e=>{e.forEach(e=>{requestAnimationFrame(()=>{G(e.target,e)})})}):null);return{disconnect:()=>{var r;null==(r=t())||r.disconnect(),e=null},observe:e=>{var r;return null==(r=t())?void 0:r.observe(e,{box:"border-box"})},unobserve:e=>{var r;return null==(r=t())?void 0:r.unobserve(e)}}})(),X=e=>{let t=e.getAttribute("data-key");return t?parseInt(t,10):-1},G=(e,t)=>{let r=X(e),l=S.get(r);if(l!==e&&(l&&B.unobserve(l),B.observe(e),S.set(r,e)),e.isConnected){let l=w(e,t),n=$.get(r);(0,i.X)(n,l)||$.set(r,l)}},P=n.useCallback(e=>{e&&G(e,void 0)},[]);return(0,l.jsx)("div",{className:(0,a.W)(W,t),ref:D,style:{cursor:L?"grabbing":"grab",...r},children:(0,l.jsxs)(b.Provider,{value:{prefixCls:W,getPrefixCls:z,defaultColor:c,rootElement:D.current},children:[(0,l.jsx)(Y,{timeRange:O}),(0,l.jsx)("div",{className:`${W}-cointent`,children:O&&o.map((e,t)=>{let r,{time:a,id:i}=e,o=function(e){let{targetTime:t,baseTime:r,tickIntervalMs:l,tickWidth:n,tickGap:a,paddingStart:i,potSize:o}=e,s=u()(t).valueOf();return(s-u()(r).valueOf())/l*(n+a)+i-o/2}({targetTime:Array.isArray(a)?a[0]:a,baseTime:O.start,tickIntervalMs:6e4,tickWidth:f.width,tickGap:8,paddingStart:f.paddingStart,potSize:8});return Array.isArray(a)&&2===a.length&&(r=function(e){let{timeRange:t,tickIntervalMs:r,tickWidth:l,tickGap:n}=e,a=u()(t.start).valueOf();return(u()(t.end).valueOf()-a)/r*(l+n)+n}({timeRange:{start:a[0],end:a[1]},tickIntervalMs:6e4,tickWidth:f.width,tickGap:8})),(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(j,{style:{transform:`translateX(${o}px)`,width:r?`${r}px`:void 0},data:e,hover:e.id===(null==F?void 0:F.id),checked:e.id===(null==A?void 0:A.id),onMouseEnter:()=>{I(e)},onMouseLeave:()=>{I(null)},onClick:()=>{T(e)}}),(0,l.jsx)(g,{style:{transform:`translateX(${o+4}px)`},position:t%2?24:100,ref:P,"data-key":e.id,hover:e.id===(null==F?void 0:F.id),checked:e.id===(null==A?void 0:A.id),data:e,onMouseEnter:()=>{I(e)},onMouseLeave:()=>{I(null)},onClick:()=>{T(e)},render:v})]},i||t)})})]})})}r(5924);let D=[{id:"1",title:"单点事件",color:"#A140E7",customRender:!1,time:"2024-03-10 10:00:00"},{id:"1111",title:"单点事件",time:"2024-03-10 10:01:00"},{id:"2",title:"时间范围事件",color:"#A140E7",customRender:!1,time:["2024-03-10 11:30:00","2024-03-10 13:30:00"]},{id:"3",title:"单点事件",customRender:!1,time:"2024-03-10 16:00:00"},{id:"4",title:"长时间范围事件",customRender:!1,time:["2024-03-10 14:15:00","2024-03-10 18:15:00"]},{id:"5",title:"长时间范围事件",customRender:!1,time:["2024-03-10 19:15:00","2024-03-10 23:15:00"]}],L=function(){return(0,l.jsx)($,{data:D,renderCard:e=>(0,l.jsx)("div",{style:{background:"#fff",width:180,height:100,borderLeft:`3px solid ${e.color}`},children:e.title})})}}}]);